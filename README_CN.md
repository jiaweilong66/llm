# llm-rag

#### 说明

llm-rag 是一个专注于优化检索和生成任务的项目，利用先进的RAG（检索增强生成）技术提高信息检索和回答生成的质量。通过查询重写、HyDE（假设文档嵌入）、层级索引构建、路由选择、检索优化及重排序等步骤，实现高效的信息检索与精准的回答生成。

高级RAG技术已被证明是一种非常有效的技术，可以提升LLM处理自然语言任务的能力，如作为聊天机器人使用。在我们的工作中，我们首先利用高级RAG完成了一项数字电路自动设计任务，具体来说是自动生成8位处理器的完整硬件描述语言代码。工作流程如图所示。
![图像](https://github.com/user-attachments/assets/c97f8291-11cc-4058-8201-5213b826d8e0)

#### 软件架构

本项目采用模块化设计，主要组件包括：
- **查询重写**：改写用户查询以提高召回率。
- **HyDE查询转换**：使用LLM生成假设性文档以辅助检索。
- **层级索引**：构建多层索引来优化检索效率。
- **工具选择路由器**：根据用户查询动态选择最适合的检索工具或信息源。
- **高级检索策略**：包括自动合并检索、混合搜索策略等。
- **重排序**：对检索结果进行重新排序以提升相关性。
![图片1](https://github.com/user-attachments/assets/3b7a8049-4a04-4420-bd2e-e7730739f2d6)

#### 安装

1. 确保已安装Python 3.x环境
2. 使用pip安装所需的依赖库：
   ```shell
   pip install -r requirements.txt
3.根据需要配置数据库连接或其他外部服务

### 贡献指南

Fork此仓库。
在本地创建新分支（命名为feat_your_feature）。
在新分支上完成你的代码改动并提交。
发起Pull Request以供审核合并

### RAG优化详情

查询重写：通过改写查询提高召回率。
HyDE查询转换：基于LLM生成假设性文档以改进检索准确性。
层级索引：构建三层索引结构（例如[2048, 512, 128]），配合AutoMergeRetriever实现子节点到父节点的自动合并检索。
工具选择路由器：通过Selector匹配查询与检索工具描述，动态选择最佳检索工具。
高级检索策略：结合向量检索与BM25检索，并通过RRF算法进行初步排名。
重排序：使用SentenceTransformerRerank类对检索结果进行重排序，确保高相关性的内容优先展示
